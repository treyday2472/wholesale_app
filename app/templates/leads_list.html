{% extends "base.html" %}
{% block content %}
<h2 class="mb-3">Leads</h2>

<form class="row g-2 mb-3">
  <div class="col-md-6">
    <input name="q" placeholder="Search name, phone, email, address, source" value="{{ q }}" class="form-control"/>
  </div>
  <div class="col-md-3">
    <select name="status" class="form-select">
      {% for s in statuses %}
        <option value="{{ s }}" {% if status==s %}selected{% endif %}>{{ s if s else "All statuses" }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <button class="btn btn-primary w-100" type="submit">Filter</button>
  </div>
</form>

<table class="table table-dark table-striped align-middle">
  <thead>
    <tr>
      <th>ID</th>
      <th>Seller</th>
      <th>Phone</th>
      <th>Address</th>
      <th>Status</th>
      <th>Source</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for lead in leads %}
      <tr>
        <td>{{ lead.id }}</td>
        <td>{{ lead.seller_name }}</td>
        <td>{{ lead.phone }}</td>
        <td>{{ lead.address }}</td>
        <td>
          <span class="badge 
            {% if lead.lead_status=='New Lead' %}bg-info
            {% elif lead.lead_status=='Contacted' %}bg-primary
            {% elif lead.lead_status=='Appointment Set' %}bg-warning
            {% elif lead.lead_status=='Offer Made' %}bg-secondary
            {% elif lead.lead_status=='Under Contract' %}bg-success
            {% elif lead.lead_status=='Closed' %}bg-success
            {% else %}bg-danger{% endif %}">
            {{ lead.lead_status }}
          </span>
        </td>
        <td>{{ lead.lead_source or '' }}</td>
        <td><a class="btn btn-sm btn-light" href="{{ url_for('main.lead_detail', lead_id=lead.id) }}">Open</a></td>
      </tr>
    {% else %}
      <tr><td colspan="7" class="text-center">No leads found.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
